(function(e){function t(t){for(var a,r,l=t[0],o=t[1],c=t[2],u=0,h=[];u<l.length;u++)r=l[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&h.push(n[r][0]),n[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);d&&d(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,l=1;l<s.length;l++){var o=s[l];0!==n[o]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},i=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=o;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("cd49")},4678:function(e,t,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="4678"},"82e5":function(e,t,s){},cd49:function(e,t,s){"use strict";s.r(t);s("fe55");var a=s("2b0e"),n=s("8c4f"),i=s("5c96"),r=s.n(i),l=s("bc3a"),o=s.n(l),c=s("acdd"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",{staticClass:"fill hfillpanel"},[s("el-header",{attrs:{height:"35"}},[s("h1",[s("a",{attrs:{href:"https://github.com/rnwood/smtp4dev/",target:"_blank"}},[s("img",{attrs:{height:"35",src:"logo.png",alt:"smtp4dev"}})])]),s("el-button",{staticStyle:{float:"right","font-size":"1.7em",padding:"6px",margin:"0 3px"},attrs:{circle:"",icon:"el-icon-setting",title:"Settings"},on:{click:function(t){e.settingsVisible=!0}}}),e._v(" "),s("hubconnstatus",{staticStyle:{float:"right"},attrs:{connection:e.connection}}),s("serverstatus",{directives:[{name:"show",rawName:"v-show",value:e.connection&&e.connection.connected,expression:"connection && connection.connected"}],staticStyle:{float:"right"},attrs:{connection:e.connection}})],1),s("settingsdialog",{attrs:{visible:e.settingsVisible,connection:e.connection},on:{closed:function(t){e.settingsVisible=!1}}}),s("el-main",{staticClass:"fill vfillpanel"},[s("el-tabs",{staticClass:"fill",attrs:{id:"maintabs",value:"messages",type:"border-card"}},[s("el-tab-pane",{staticClass:"vfillpanel",attrs:{label:"Messages",name:"messages"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-message"}),e._v(" Messages ")]),s("splitpanes",{staticClass:"default-theme fill",on:{resize:function(t){e.messageListPaneSize=t[0].size}}},[s("pane",{staticClass:"hfillpanel",attrs:{size:e.messageListPaneSize}},[s("messagelist",{staticClass:"fill",attrs:{connection:e.connection},on:{"selected-message-changed":e.selectedMessageChanged}})],1),s("pane",{staticClass:"hfillpanel",attrs:{size:100-e.messageListPaneSize}},[s("messageview",{staticClass:"fill",attrs:{"message-summary":e.selectedMessage}})],1)],1)],1),s("el-tab-pane",{staticClass:"vfillpanel",attrs:{label:"Sessions",name:"sessions"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-monitor"}),e._v(" Sessions ")]),s("splitpanes",{staticClass:"default-theme fill",on:{resize:function(t){e.sessionListPaneSize=t[0].size}}},[s("pane",{staticClass:"vfillpanel",attrs:{size:e.sessionListPaneSize}},[s("sessionlist",{staticClass:"fill",attrs:{connection:e.connection},on:{"selected-session-changed":e.selectedSessionChanged}})],1),s("pane",{staticClass:"vfillpanel",attrs:{size:100-e.sessionListPaneSize}},[s("sessionview",{staticClass:"fill",attrs:{"session-summary":e.selectedSession}})],1)],1)],1)],1)],1)],1)},u=[],h=s("9ab4"),m=s("1b40"),g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messagelist"},[s("div",{staticClass:"toolbar"},[s("confirmationdialog",{attrs:{"always-key":"deleteAllMessages",message:"Are you sure you want to delete all messages?"},on:{confirm:e.clear}},[s("el-button",{attrs:{icon:"el-icon-close",title:"Clear"}})],1),s("el-button",{attrs:{icon:"el-icon-delete",disabled:!e.selectedmessage,title:"Delete"},on:{click:e.deleteSelected}}),s("el-button",{attrs:{icon:"el-icon-refresh",disabled:e.loading,title:"Refresh"},on:{click:e.refresh}}),s("el-button",{attrs:{icon:"el-icon-d-arrow-right",disabled:!e.selectedmessage||!e.isRelayAvailable,loading:e.isRelayInProgress,title:"Relay"},on:{click:e.relaySelected}}),s("el-input",{staticStyle:{float:"right",width:"35%","min-width":"150px"},attrs:{clearable:"",placeholder:"Search","prefix-icon":"el-icon-search"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1),e.error?s("el-alert",{attrs:{type:"error",title:"Error","show-icon":""}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.refresh}},[e._v("Retry")])],1):e._e(),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticClass:"table",attrs:{data:e.filteredMessages,"empty-text":e.emptyText,"highlight-current-row":"","default-sort":{prop:"receivedDate",order:"descending"},type:"selection","reserve-selection":"true","row-key":"id","row-class-name":e.getRowClass,stripe:""},on:{"current-change":e.handleCurrentChange,"sort-change":e.sort}},[s("el-table-column",{attrs:{property:"receivedDate",label:"Received",width:"180",sortable:"custom",formatter:e.formatDate}}),s("el-table-column",{attrs:{property:"from",label:"From",width:"120",sortable:"custom"}}),s("el-table-column",{attrs:{property:"to",label:"To",width:"120",sortable:"custom"}}),s("el-table-column",{attrs:{property:"subject",label:"Subject",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.subject)+" "),t.row.attachmentCount?s("i",{staticClass:"el-icon-paperclip",attrs:{title:t.row.attachmentCount+" attachments"}}):e._e()]}}])})],1)],1)},p=[];class f{constructor(){}getSummaries_url(e,t){return`api/Messages?sortColumn=${encodeURIComponent(e)}&sortIsDescending=${t}`}async getSummaries(e,t){return(await o.a.get(this.getSummaries_url(e,t),void 0)).data}getMessage_url(e){return"api/Messages/"+encodeURIComponent(e)}async getMessage(e){return(await o.a.get(this.getMessage_url(e),void 0)).data}markMessageRead_url(e){return"api/Messages/"+encodeURIComponent(e)}async markMessageRead(e){return(await o.a.post(this.markMessageRead_url(e),void 0)).data}downloadMessage_url(e){return`api/Messages/${encodeURIComponent(e)}/download`}async downloadMessage(e){return(await o.a.get(this.downloadMessage_url(e),void 0)).data}relayMessage_url(e){return`api/Messages/${encodeURIComponent(e)}/relay`}async relayMessage(e,t){return(await o.a.post(this.relayMessage_url(e),t||void 0)).data}getPartContent_url(e,t){return`api/Messages/${encodeURIComponent(e)}/part/${encodeURIComponent(t)}/content`}async getPartContent(e,t){return(await o.a.get(this.getPartContent_url(e,t),void 0)).data}getPartSource_url(e,t){return`api/Messages/${encodeURIComponent(e)}/part/${encodeURIComponent(t)}/source`}async getPartSource(e,t){return(await o.a.get(this.getPartSource_url(e,t),void 0)).data}getPartSourceRaw_url(e,t){return`api/Messages/${encodeURIComponent(e)}/part/${encodeURIComponent(t)}/raw`}async getPartSourceRaw(e,t){return(await o.a.get(this.getPartSourceRaw_url(e,t),void 0)).data}getMessageSourceRaw_url(e){return`api/Messages/${encodeURIComponent(e)}/raw`}async getMessageSourceRaw(e){return(await o.a.get(this.getMessageSourceRaw_url(e),void 0)).data}getMessageSource_url(e){return`api/Messages/${encodeURIComponent(e)}/source`}async getMessageSource(e){return(await o.a.get(this.getMessageSource_url(e),void 0)).data}getMessageHtml_url(e){return`api/Messages/${encodeURIComponent(e)}/html`}async getMessageHtml(e){return(await o.a.get(this.getMessageHtml_url(e),void 0)).data}delete_url(e){return"api/Messages/"+encodeURIComponent(e)}async delete(e){return(await o.a.delete(this.delete_url(e),void 0)).data}deleteAll_url(){return"api/Messages/*"}async deleteAll(){return(await o.a.delete(this.deleteAll_url(),void 0)).data}}var b=s("c1df");function v(e,t,s,a=null){if(a)for(const n of e){const e=t.find(e=>s(e,n));e&&a(n,e)}for(const n of t.filter(t=>-1===e.findIndex(e=>s(t,e))))t.splice(t.findIndex(e=>s(e,n)),1);for(const n of e.filter(e=>-1===t.findIndex(t=>s(e,t))))t.splice(e.findIndex(e=>s(e,n)),0,n)}var y=s("abaf"),w=s("1ea6");class j{constructor(e){this.lastNotifiedMessage=null,this.visibleNotificationCloseTimeout=null,this.currentNotification=null,this.updateNotificationsDebounced=Object(w["a"])(this.updateNotifications,500),"default"==Notification.permission&&Notification.requestPermission(),this.onClick=e}setInitialMessages(e){const t=this.sortMessages(e);this.lastNotifiedMessage=t[t.length-1]}notifyMessages(e){this.updateNotificationsDebounced(e)}updateNotifications(e){const t=this.sortMessages(e);let s;if(this.lastNotifiedMessage){const e=t.indexOf(this.lastNotifiedMessage);s=-1!=e?t.slice(e+1):t}else s=t;if(s.length)if(s.reverse(),"granted"!=Notification.permission)this.lastNotifiedMessage=s[0];else{this.visibleNotificationCloseTimeout&&clearTimeout(this.visibleNotificationCloseTimeout);const e=this.currentNotification=new Notification("smtp4dev: "+s.length+" new message(s) received.",{body:s.slice(0,5).map(e=>"From: "+e.from+" - "+e.subject).join("\n")+(s.length>5?"...":""),tag:"newmessages",renotify:!0,silent:!!this.currentNotification,requireInteraction:!1});e.onclick=()=>{this.onClick(s[0])},e.onclose=()=>{e===this.currentNotification&&(this.currentNotification=null,this.lastNotifiedMessage=s[0])},this.visibleNotificationCloseTimeout=setTimeout(()=>{e===this.currentNotification&&this.currentNotification.close()},1e4)}}sortMessages(e){const t=e.slice(0,e.length);return t.sort((e,t)=>e.receivedDate==t.receivedDate?e.id>t.id?1:-1:e.receivedDate>t.receivedDate?1:-1),t}}var _=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-popover",{attrs:{placement:"bottom",width:"160",trigger:"manual"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[s("p",[e._v(e._s(e.message))]),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.cancel()}}},[e._v("cancel")]),e.alwaysIsAvailable()?s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.confirm(!0)}}},[e._v("always")]):e._e(),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.confirm(!1)}}},[e._v("confirm")])],1),e._t("default",null,{slot:"reference"})],2)],1)},S=[];let C=class extends a["default"]{constructor(){super(),this.visible=!1}mounted(){if(this.$slots.default&&this.$slots.default.length>0&&this.$slots.default[0].componentInstance&&(this.$slots.default[0].componentInstance.$on("click",this.getConfirmation),this.$el.parentElement)){var e=this.$el.parentElement;e.insertBefore(this.$slots.default[0].componentInstance.$el,this.$el),e.removeChild(this.$el)}}alwaysIsAvailable(){return this.alwaysKey&&window.localStorage}cancel(){this.visible=!1}confirm(e){e&&window.localStorage.setItem("always-"+this.alwaysKey,"true"),this.visible=!1,this.$emit("confirm")}checkReferenceVisible(){this.visible&&(this.$slots.default&&this.$slots.default.length>0&&this.$slots.default[0].componentInstance&&(!this.$slots.default[0].componentInstance.$el).offsetParent&&(this.visible=!1),setTimeout(this.checkReferenceVisible,100))}getConfirmation(){this.alwaysIsAvailable()&&"true"===window.localStorage.getItem("always-"+this.alwaysKey)?this.confirm(!1):(this.visible=!0,setTimeout(this.checkReferenceVisible,100))}};Object(h["a"])([Object(m["b"])({default:""})],C.prototype,"message",void 0),Object(h["a"])([Object(m["b"])({default:void 0})],C.prototype,"alwaysKey",void 0),C=Object(h["a"])([m["a"]],C);var O=C,M=O,x=s("2877"),k=Object(x["a"])(M,_,S,!1,null,null,null),R=k.exports;class E{constructor(){}getServer_url(){return"api/Server"}async getServer(){return(await o.a.get(this.getServer_url(),void 0)).data}updateServer_url(){return"api/Server"}async updateServer(e){return(await o.a.post(this.updateServer_url(),e||void 0)).data}}function P(e,t,s){return e.sort((function(e,a){const n=e[s],i=a[s];return t.indexOf(n)>t.indexOf(i)?1:-1})),e}let N=class extends a["default"]{constructor(){super(),this.selectedSortDescending=!0,this.selectedSortColumn="receivedDate",this.connection=null,this.messages=[],this.filteredMessages=[],this.isRelayInProgress=!1,this.isRelayAvailable=!1,this.emptyText="No messages",this.error=null,this.selectedmessage=null,this.searchTerm="",this.loading=!0,this.messageNotificationManager=new j(e=>{this.selectMessage(e),this.handleCurrentChange(e)}),this.debouncedUpdateFilteredMessages=Object(w["a"])(this.updateFilteredMessages,200),this.lastSort=null,this.lastSortDescending=!1,this.mutex=new y["a"],this.initialLoadDone=!1}selectMessage(e){this.$refs.table.setCurrentRow(e),this.handleCurrentChange(e)}handleCurrentChange(e){this.selectedmessage=e,this.$emit("selected-message-changed",e)}formatDate(e,t,s){return b(s).format("YYYY-MM-DD HH:mm:ss")}getRowClass(e){return e.row.isUnread?"unread":"read"}async relaySelected(){var e,t,s;if(null==this.selectedmessage)return;let a;try{let e=await this.$prompt("Email address(es) to relay to (separate multiple with ,)","Relay Message",{confirmButtonText:"OK",inputValue:this.selectedmessage.to,cancelButtonText:"Cancel",inputPattern:/[^, ]+(, *[^, ]+)*/,inputErrorMessage:"Invalid email addresses"});a=e.value.split(",").map(e=>e.trim())}catch(i){return}try{this.isRelayInProgress=!0,await(new f).relayMessage(this.selectedmessage.id,{overrideRecipientAddresses:a}),this.$notify.success({title:"Relay Message Success",message:"Completed OK"})}catch(r){var n=null!==(s=null===(t=null===(e=r.response)||void 0===e?void 0:e.data)||void 0===t?void 0:t.detail)&&void 0!==s?s:r.sessage;this.$notify.error({title:"Relay Message Failed",message:n})}finally{this.isRelayInProgress=!1}}async deleteSelected(){if(null==this.selectedmessage)return;this.loading=!0;let e=this.selectedmessage,t=this.filteredMessages.indexOf(e)+1;t<this.filteredMessages.length&&this.selectMessage(this.filteredMessages[t]);try{await(new f).delete(e.id),await this.refresh()}catch(s){this.$notify.error({title:"Delete Message Failed",message:s.message})}finally{this.loading=!1}}async clear(){try{this.loading=!0,await(new f).deleteAll(),await this.refresh()}catch(e){this.$notify.error({title:"Clear Messages Failed",message:e.message})}finally{this.loading=!1}}doSearch(){this.loading=!0,this.debouncedUpdateFilteredMessages()}updateFilteredMessages(){try{this.loading=!0,this.searchTerm?this.emptyText="No messages matching '"+this.searchTerm+"'":this.emptyText="No messages",v(this.messages.filter(e=>this.searchTermPredicate(e)),this.filteredMessages,(e,t)=>e.id==t.id,(e,t)=>{t.isUnread=e.isUnread});const e=this.messages.map(e=>e.id);this.filteredMessages=P(this.filteredMessages,e,"id"),this.filteredMessages.some(e=>null!=this.selectedmessage&&e.id==this.selectedmessage.id)||this.handleCurrentChange(null)}finally{this.loading=!1}}searchTermPredicate(e){return!this.searchTerm||-1!=e.subject.localeIndexOf(this.searchTerm,void 0,{sensitivity:"base"})||-1!=e.to.localeIndexOf(this.searchTerm,void 0,{sensitivity:"base"})||-1!=e.from.localeIndexOf(this.searchTerm,void 0,{sensitivity:"base"})}async refresh(e=!1){var t=await this.mutex.acquire();try{this.error=null,this.loading=!e;let s=this.selectedSortColumn,a=this.selectedSortDescending,n=await(new f).getSummaries(s,a);this.lastSort&&this.lastSort==s&&this.lastSortDescending==a&&0!=n.length?v(n,this.messages,(e,t)=>e.id==t.id,(e,t)=>{t.isUnread=e.isUnread}):this.messages.splice(0,this.messages.length,...n),this.initialLoadDone?this.messageNotificationManager.notifyMessages(this.messages):this.messageNotificationManager.setInitialMessages(this.messages),this.updateFilteredMessages(),this.initialLoadDone=!0,this.lastSort=s,this.lastSortDescending=this.selectedSortDescending,this.isRelayAvailable=!!await(await(new E).getServer()).relayOptions.smtpServer}catch(s){this.error=s}finally{this.loading=!1,t()}}async sort(e){let t=!0;"ascending"===e.order&&(t=!1),this.selectedSortColumn==e.prop&&this.selectedSortDescending==t||(this.selectedSortColumn=e.prop||"receivedDate",this.selectedSortDescending=t,await this.refresh())}async mounted(){await this.refresh(!1)}async onConnectionChanged(){this.connection&&(this.connection.on("messageschanged",async()=>{await this.refresh(!0)}),this.connection.on("serverchanged",async()=>{await this.refresh(!0)}),this.connection.addOnConnectedCallback(()=>{this.refresh(!0)}))}};Object(h["a"])([Object(m["b"])({default:null})],N.prototype,"connection",void 0),Object(h["a"])([Object(m["c"])("searchTerm")],N.prototype,"doSearch",null),Object(h["a"])([Object(m["c"])("connection")],N.prototype,"onConnectionChanged",null),N=Object(h["a"])([Object(m["a"])({components:{confirmationdialog:R}})],N);var $=N,T=$,I=Object(x["a"])(T,g,p,!1,null,null,null),z=I.exports,A=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"messageview fill vfillpanel"},[e.error?s("el-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.loadMessage}},[e._v("Retry")])],1):e._e(),e.messageSummary?s("div",{staticClass:"hfillpanel fill"},[s("div",{staticClass:"toolbar"},[s("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.download}},[e._v("Download")])],1),s("div",{staticClass:"pad"},[e._l(e.warnings,(function(e){return s("el-alert",{key:e.details,attrs:{title:"Warning: "+e.details,type:"warning","show-icon":""}})})),s("table",{staticClass:"messageviewheader"},[s("tr",[s("td",[e._v("From:")]),s("td",[e.message?s("span",[e._v(e._s(e.message.from))]):e._e()])]),s("tr",[s("td",[e._v("To:")]),s("td",[e.message?s("span",[e._v(e._s(e.message.to))]):e._e()])]),e.message&&e.message.cc?s("tr",[s("td",[e._v("Cc:")]),s("td",[e._v(e._s(e.message.cc))])]):e._e(),e.message&&e.message.bcc?s("tr",[s("td",[e._v("Bcc:")]),s("td",[e._v(e._s(e.message.bcc))])]):e._e(),s("tr",[s("td",[e._v("Subject:")]),s("td",[e.message?s("span",[e._v(e._s(e.message.subject))]):e._e()])]),s("tr",[s("td",[e._v("Secure:")]),s("td",[e.message?s("span",[e._v(e._s(e.message.secureConnection))]):e._e()])])]),e.message&&e.message.relayError?s("div",[s("el-alert",{attrs:{type:"error"}},[e._v("Message relay error: "+e._s(e.message.relayError))])],1):e._e(),e.message&&e.message.mimeParseError?[s("el-alert",{attrs:{type:"error"}},[e._v("Message parse error: "+e._s(e.message.mimeParseError))])]:e._e()],2),s("el-tabs",{staticClass:"fill",staticStyle:{height:"100%",width:"100%"},attrs:{value:"view",type:"border-card"}},[s("el-tab-pane",{staticClass:"hfillpanel",attrs:{name:"view"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-view"}),e._v(" View ")]),s("messageviewattachments",{attrs:{message:e.message}}),s("messageview-html",{staticClass:"fill",attrs:{message:e.message}})],1),s("el-tab-pane",{staticClass:"hfillpanel",attrs:{name:"headers"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-notebook-2"}),e._v(" Headers ")]),s("headers",{staticClass:"fill",attrs:{headers:e.headers}})],1),s("el-tab-pane",{staticClass:"hfillpanel",attrs:{name:"parts"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document-copy"}),e._v(" Parts ")]),e.message?s("el-tree",{ref:"partstree",attrs:{data:e.message.parts,props:{label:"name",children:"childParts",disabled:!1,isLeaf:e.isLeaf},"highlight-current":"","empty-message":"No parts",accordion:"","node-key":"id","default-expanded-keys":["0"]},on:{"node-click":e.onPartSelection},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,n=t.data;return s("span",{staticClass:"custom-tree-node"},[s("i",{class:{"el-icon-document-copy":n.childParts.length,"el-icon-document":0==n.childParts.length&&!n.isAttachment,"el-icon-paperclip":0==n.childParts.length&&n.isAttachment}}),e._v(" "+e._s(a.label)+" ")])}}],null,!1,1581920248)}):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedPart,expression:"selectedPart"}],staticClass:"fill vfillpanel"},[s("el-tabs",{staticClass:"fill hfillpanel",attrs:{value:"headers",type:"border-card"}},[s("el-tab-pane",{staticClass:"fill vfillpanel",attrs:{label:"Headers",name:"headers"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-notebook-2"}),e._v(" Headers ")]),s("headers",{staticClass:"fill",attrs:{headers:e.selectedPartHeaders}})],1),s("el-tab-pane",{staticClass:"fill vfillpanel",attrs:{label:"Source",name:"source"}},[s("messagepartsource",{staticClass:"fill",attrs:{messageEntitySummary:e.selectedPart,type:"source"}})],1),s("el-tab-pane",{staticClass:"fill vfillpanel",attrs:{label:"Raw",name:"raw"}},[s("messagepartsource",{staticClass:"fill",attrs:{messageEntitySummary:e.selectedPart,type:"raw"}})],1)],1)],1),e.selectedPart?e._e():s("div",{staticClass:"fill vfillpanel"},[s("div",{staticClass:"fill nodetails centrecontents"},[s("div",[e._v("No part selected.")])])])],1),s("el-tab-pane",{staticClass:"fill vfillpanel",attrs:{label:"Source",name:"source"}},[s("messagesource",{staticClass:"fill",attrs:{message:e.message,type:"source"}})],1)],1)],1):e._e(),e.messageSummary?e._e():s("div",{staticClass:"fill nodetails centrecontents"},[s("div",[e._v("No message selected.")])])],1)},D=[],U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.headers,expression:"headers"}],staticClass:"headers"},[s("el-table",{staticClass:"table fill",attrs:{data:e.headers,"empty-text":"No headers","default-sort":{prop:"name",order:"ascending"},stripe:""}},[s("el-table-column",{attrs:{property:"name",label:"Name",width:"150",sortable:""}}),s("el-table-column",{attrs:{property:"value",label:"Value",sortable:""}})],1)],1)},L=[];let q=class extends a["default"]{constructor(){super()}async destroyed(){}};Object(h["a"])([Object(m["b"])({default:[]})],q.prototype,"headers",void 0),q=Object(h["a"])([m["a"]],q);var K=q,H=K,F=Object(x["a"])(H,U,L,!1,null,null,null),V=F.exports,Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.html,expression:"!html"}],staticClass:"hfillpanel"},[e.error?s("el-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.loadMessage}},[e._v("Retry")])],1):e._e(),s("iframe",{ref:"htmlframe",staticClass:"fill",on:{load:e.onHtmlFrameLoaded}})],1)},W=[],B=s("60f1");let J=class extends a["default"]{constructor(){super(),this.message=null,this.html=null,this.error=null,this.loading=!1}async onMessageChanged(e,t){await this.loadMessage()}async onHtmlChanged(e){B["set"](this.$refs.htmlframe,e)}async onHtmlFrameLoaded(){var e=this.$refs.htmlframe.contentDocument;if(e){var t=e.body.querySelector("base")||e.createElement("base");t.setAttribute("target","_blank"),e.body.appendChild(t)}}async loadMessage(){this.error=null,this.loading=!0,this.html=null;try{null!=this.message&&(this.html=await(new f).getMessageHtml(this.message.id))}catch(e){this.error=e}finally{this.loading=!1}}async created(){this.loadMessage()}async destroyed(){}};Object(h["a"])([Object(m["b"])({default:null})],J.prototype,"message",void 0),Object(h["a"])([Object(m["c"])("message")],J.prototype,"onMessageChanged",null),Object(h["a"])([Object(m["c"])("html")],J.prototype,"onHtmlChanged",null),J=Object(h["a"])([m["a"]],J);var Z=J,G=Z,Q=Object(x["a"])(G,Y,W,!1,null,null,null),X=Q.exports,ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.attachments,expression:"attachments"}],staticClass:"vfillpanel pad"},e._l(e.attachments,(function(t){return s("div",{key:t.id},[s("el-button",{attrs:{icon:"el-icon-paperclip",size:"small",type:"primary",round:""},on:{click:function(s){return e.openAttachment(t)}}},[e._v(e._s(t.fileName))])],1)})),0)},te=[];let se=class extends a["default"]{constructor(){super(),this.message=null,this.attachments=null}async onMessageChanged(e,t){await this.setAttachments()}async setAttachments(){var e=[];if(null!=this.message){var t=this.message.parts;this.getAttachments(t,e)}this.attachments=e}getAttachments(e,t){for(let s of e){for(let e of s.attachments)t.push(e);this.getAttachments(s.childParts,t)}}openAttachment(e){window.open(e.url)}async created(){await this.setAttachments()}async destroyed(){}};Object(h["a"])([Object(m["b"])({default:null})],se.prototype,"message",void 0),Object(h["a"])([Object(m["c"])("message")],se.prototype,"onMessageChanged",null),se=Object(h["a"])([m["a"]],se);var ae=se,ne=ae,ie=Object(x["a"])(ne,ee,te,!1,null,null,null),re=ie.exports,le=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"hfillpanel"},[e.error?s("el-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.loadMessage}},[e._v("Retry")])],1):e._e(),s("div",{staticClass:"toolbar"},[s("el-button",{attrs:{size:"small",icon:"el-icon-document"},on:{click:e.download}},[e._v("Open")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.source,expression:"source"}],staticClass:"vfillpanel fill"},[s("textview",{staticClass:"fill",attrs:{text:e.source}})],1)],1)},oe=[],ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("aceeditor",{attrs:{lang:"text",theme:"chrome",width:"100%",height:"100%"},on:{init:e.editorInit},model:{value:e.textToShow,callback:function(t){e.textToShow=t},expression:"textToShow"}})],1)},de=[],ue=s("7c9e"),he=s.n(ue);let me=class extends a["default"]{constructor(){super(),this.text=null}editorInit(e){s("2099"),s("8a2a"),s("95b8"),s("6a21"),e.setReadOnly(!0)}get textToShow(){return this.text?this.text:""}set textToShow(e){}async destroyed(){}};Object(h["a"])([Object(m["b"])()],me.prototype,"text",void 0),me=Object(h["a"])([Object(m["a"])({components:{aceeditor:he.a}})],me);var ge=me,pe=ge,fe=Object(x["a"])(pe,ce,de,!1,null,null,null),be=fe.exports;let ve=class extends a["default"]{constructor(){super(),this.messageEntitySummary=null,this.source=null,this.sourceurl=null,this.error=null,this.loading=!1}async onMessageEntitySummaryChanged(e,t){await this.loadMessage()}download(){this.sourceurl&&window.open(this.sourceurl)}async loadMessage(){this.error=null,this.loading=!0,this.source=null,this.sourceurl=null;try{null!=this.messageEntitySummary&&("raw"===this.type?(this.sourceurl=(new f).getPartSourceRaw_url(this.messageEntitySummary.messageId,this.messageEntitySummary.id),this.source=await(new f).getPartSourceRaw(this.messageEntitySummary.messageId,this.messageEntitySummary.id)):(this.sourceurl=(new f).getPartSource_url(this.messageEntitySummary.messageId,this.messageEntitySummary.id),this.source=await(new f).getPartSource(this.messageEntitySummary.messageId,this.messageEntitySummary.id)))}catch(e){this.error=e}finally{this.loading=!1}}async created(){this.loadMessage()}async destroyed(){}};Object(h["a"])([Object(m["b"])()],ve.prototype,"messageEntitySummary",void 0),Object(h["a"])([Object(m["b"])({default:"source"})],ve.prototype,"type",void 0),Object(h["a"])([Object(m["c"])("messageEntitySummary")],ve.prototype,"onMessageEntitySummaryChanged",null),ve=Object(h["a"])([Object(m["a"])({components:{textview:be}})],ve);var ye=ve,we=ye,je=Object(x["a"])(we,le,oe,!1,null,null,null),_e=je.exports,Se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"hfillpanel"},[e.error?s("el-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.loadMessage}},[e._v("Retry")])],1):e._e(),s("div",{staticClass:"toolbar"},[s("el-button",{attrs:{size:"small"},on:{click:e.download}},[e._v("Open")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.source,expression:"source"}],staticClass:"vfillpanel fill"},[s("textview",{staticClass:"fill",attrs:{text:e.source}})],1)],1)},Ce=[];let Oe=class extends a["default"]{constructor(){super(),this.message=null,this.source=null,this.sourceurl=null,this.error=null,this.loading=!1}async onMessageChanged(e,t){await this.loadMessage()}download(){this.sourceurl&&window.open(this.sourceurl)}async loadMessage(){this.error=null,this.loading=!0,this.source=null,this.sourceurl=null;try{null!=this.message&&("raw"===this.type?(this.sourceurl=(new f).getMessageSourceRaw_url(this.message.id),this.source=await(new f).getMessageSourceRaw(this.message.id)):(this.sourceurl=(new f).getMessageSource_url(this.message.id),this.source=await(new f).getMessageSourceRaw(this.message.id)))}catch(e){this.error=e}finally{this.loading=!1}}async created(){this.loadMessage()}async destroyed(){}};Object(h["a"])([Object(m["b"])()],Oe.prototype,"message",void 0),Object(h["a"])([Object(m["b"])({default:"source"})],Oe.prototype,"type",void 0),Object(h["a"])([Object(m["c"])("message")],Oe.prototype,"onMessageChanged",null),Oe=Object(h["a"])([Object(m["a"])({components:{textview:be}})],Oe);var Me=Oe,xe=Me,ke=Object(x["a"])(xe,Se,Ce,!1,null,null,null),Re=ke.exports;let Ee=class extends a["default"]{constructor(){super(),this.messageSummary=null,this.message=null,this.selectedPart=null,this.warnings=[],this.error=null,this.loading=!1}async onMessageSummaryChange(e,t){await this.loadMessage()}async loadMessage(){this.error=null,this.loading=!0,this.message=null,this.selectedPart=null;try{if(null!=this.messageSummary&&(this.message=await(new f).getMessage(this.messageSummary.id),this.$refs.partstree&&this.$refs.partstree.setCurrentNode(this.$refs.partstree.getNode(0)),this.setWarnings(),this.messageSummary.isUnread)){var e=this.messageSummary;setTimeout(async()=>{if(null!=this.messageSummary&&e.id==this.messageSummary.id)try{await(new f).markMessageRead(this.messageSummary.id)}catch(t){console.error(t)}},2e3)}}catch(t){this.error=t}finally{this.loading=!1}}async setWarnings(){var e=[];if(null!=this.message){var t=this.message.parts;this.getWarnings(t,e)}this.warnings=e}getWarnings(e,t){for(let s of e){for(let e of s.warnings)t.push(e);this.getWarnings(s.childParts,t)}}isLeaf(e){return!e.length&&!e.childParts.length}onPartSelection(e){this.selectedPart=e}async download(){null!=this.messageSummary&&window.open((new f).downloadMessage_url(this.messageSummary.id))}async mounted(){await this.loadMessage()}async destroyed(){}get headers(){return null!=this.message?this.message.headers:[]}get selectedPartHeaders(){return null!=this.selectedPart?this.selectedPart.headers:[]}};Object(h["a"])([Object(m["b"])({})],Ee.prototype,"messageSummary",void 0),Object(h["a"])([Object(m["c"])("messageSummary")],Ee.prototype,"onMessageSummaryChange",null),Ee=Object(h["a"])([Object(m["a"])({components:{headers:V,"messageview-html":X,messageviewattachments:re,messagepartsource:_e,messagesource:Re}})],Ee);var Pe=Ee,Ne=Pe,$e=Object(x["a"])(Ne,A,D,!1,null,null,null),Te=$e.exports,Ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sessionlist"},[s("div",{staticClass:"toolbar"},[s("confirmationdialog",{attrs:{"always-key":"deleteAllSessions",message:"Are you sure you want to delete all sessions?"},on:{confirm:e.clear}},[s("el-button",{attrs:{icon:"el-icon-close",title:"Clear"}})],1),s("el-button",{attrs:{icon:"el-icon-delete",disabled:!e.selectedsession,title:"Delete"},on:{click:e.deleteSelected}}),s("el-button",{attrs:{icon:"el-icon-refresh",disabled:e.loading,title:"Refresh"},on:{click:e.refresh}})],1),e.error?s("el-alert",{attrs:{type:"error",title:"Error","show-icon":""}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.refresh}},[e._v("Retry")])],1):e._e(),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticClass:"table",attrs:{data:e.sessions,"empty-text":"No sessions","highlight-current-row":"","default-sort":{prop:"endDate",order:"descending"},type:"selection","reserve-selection":"true","row-key":"id",stripe:""},on:{"current-change":e.handleCurrentChange}},[s("el-table-column",{attrs:{property:"endDate",label:"End Date",width:"120",sortable:"",formatter:e.formatDate}}),s("el-table-column",{attrs:{property:"clientAddress",label:"Client Address",sortable:""}}),s("el-table-column",{attrs:{property:"numberOfMessages",label:"# Msgs",width:"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.terminatedWithError?s("i",{staticClass:"el-icon-warning",attrs:{title:"This session terminated abnormally"}}):e._e(),e._v(" "+e._s(t.row.numberOfMessages)+" ")]}}])})],1)],1)},ze=[];class Ae{constructor(){}getSummaries_url(){return"api/Sessions"}async getSummaries(){return(await o.a.get(this.getSummaries_url(),void 0)).data}getSession_url(e){return"api/Sessions/"+encodeURIComponent(e)}async getSession(e){return(await o.a.get(this.getSession_url(e),void 0)).data}getSessionLog_url(e){return`api/Sessions/${encodeURIComponent(e)}/log`}async getSessionLog(e){return(await o.a.get(this.getSessionLog_url(e),void 0)).data}delete_url(e){return"api/Sessions/"+encodeURIComponent(e)}async delete(e){return(await o.a.delete(this.delete_url(e),void 0)).data}deleteAll_url(){return"api/Sessions/*"}async deleteAll(){return(await o.a.delete(this.deleteAll_url(),void 0)).data}}let De=class extends a["default"]{constructor(){super(),this.connection=null,this.sessions=[],this.error=null,this.selectedsession=null,this.loading=!0,this.mutex=new y["a"]}handleCurrentChange(e){this.selectedsession=e,this.$emit("selected-session-changed",e)}formatDate(e,t,s,a){return b(s).format("YYYY-MM-DD HH:mm:ss")}selectSession(e){this.$refs.table.setCurrentRow(e),this.handleCurrentChange(e)}async deleteSelected(){if(null==this.selectedsession)return;this.loading=!0;let e=this.selectedsession,t=this.sessions.indexOf(e)-1;t>=0&&this.selectSession(this.sessions[t]);try{await(new Ae).delete(e.id),this.refresh()}catch(s){this.$notify.error({title:"Delete Session Failed",message:s.message})}finally{this.loading=!1}}async clear(){this.loading=!0;try{await(new Ae).deleteAll(),this.refresh()}catch(e){this.$notify.error({title:"Clear Sessions Failed",message:e.message})}finally{this.loading=!1}}async refresh(e=!1){var t=await this.mutex.acquire();try{this.error=null,this.loading=!e;var s=await(new Ae).getSummaries();v(s,this.sessions,(e,t)=>e.id==t.id),this.sessions.some(e=>null!=this.selectedsession&&e.id==this.selectedsession.id)||this.handleCurrentChange(null)}catch(a){this.error=a}finally{this.loading=!1,t()}}async mounted(){this.refresh(!1)}async onConnectionChanged(){this.connection&&(this.connection.on("sessionschanged",()=>{this.refresh(!0)}),this.connection.addOnConnectedCallback(()=>this.refresh(!0)))}};Object(h["a"])([Object(m["b"])({default:null})],De.prototype,"connection",void 0),Object(h["a"])([Object(m["c"])("connection")],De.prototype,"onConnectionChanged",null),De=Object(h["a"])([Object(m["a"])({components:{confirmationdialog:R}})],De);var Ue=De,Le=Ue,qe=Object(x["a"])(Le,Ie,ze,!1,null,null,null),Ke=qe.exports,He=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"sessionview fill vfillpanel"},[e.error?s("el-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.error.message)+" "),s("el-button",{on:{click:e.loadMessage}},[e._v("Retry")])],1):e._e(),e.error?s("div",{staticClass:"hfillpanel fill"}):e._e(),e.sessionSummary?s("div",{staticClass:"hfillpanel fill"},[e.session&&e.session.error?s("el-alert",{attrs:{type:"warning","show-icon":"",title:"This session terminated abnormally"}},[e._v(e._s(e.session.error))]):e._e(),s("el-tabs",{staticClass:"fill",staticStyle:{height:"100%",width:"100%"},attrs:{value:"log",type:"border-card"}},[s("el-tab-pane",{staticClass:"hfillpanel",attrs:{name:"log"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-notebook-2"}),e._v(" Log ")]),s("div",{staticClass:"toolbar"},[s("el-button",{attrs:{size:"small"},on:{click:e.download}},[e._v("Open")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.log,expression:"log"}],staticClass:"vfillpanel fill"},[s("textview",{staticClass:"fill",attrs:{text:e.log}})],1)])],1)],1):e._e(),e.sessionSummary?e._e():s("div",{staticClass:"fill nodetails centrecontents"},[s("div",[e._v("No session selected")])])],1)},Fe=[];let Ve=class extends a["default"]{constructor(){super(),this.sessionSummary=null,this.session=null,this.log=null,this.error=null,this.loading=!1}async onMessageChanged(e,t){await this.loadSession()}download(){this.sessionSummary&&window.open((new Ae).getSessionLog_url(this.sessionSummary.id))}async loadSession(){this.error=null,this.loading=!0,this.session=null,this.log=null;try{null!=this.sessionSummary&&(this.session=await(new Ae).getSession(this.sessionSummary.id),this.log=await(new Ae).getSessionLog(this.sessionSummary.id))}catch(e){this.error=e}finally{this.loading=!1}}async created(){}async destroyed(){}};Object(h["a"])([Object(m["b"])({})],Ve.prototype,"sessionSummary",void 0),Object(h["a"])([Object(m["c"])("sessionSummary")],Ve.prototype,"onMessageChanged",null),Ve=Object(h["a"])([Object(m["a"])({components:{textview:be}})],Ve);var Ye=Ve,We=Ye,Be=Object(x["a"])(We,He,Fe,!1,null,null,null),Je=Be.exports,Ze=s("1a9a");class Ge{constructor(e){this.connected=!1,this.connectedCallbacks=[],this.started=!1,this.error=null,this._connection=(new Ze["a"]).withUrl(e).configureLogging(Ze["b"].Trace).build(),this._connection.onclose(this.onConnectionClosed.bind(this))}async addOnConnectedCallback(e){this.connectedCallbacks.push(e),this.connected&&e()}async start(){if(!this.started){this.error=null,this.started=!0;try{await this._connection.start(),this.connected=!0;for(const e of this.connectedCallbacks)e()}catch(e){this.error=e}}}async stop(){this.started=!1,await this._connection.stop()}onConnectionClosed(e){this.connected=!1,this.started=!1,this.error=e||null}on(e,t){this._connection.on(e,t)}}var Qe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.server&&e.server.isRunning?s("el-button",{attrs:{icon:"el-icon-circle-check",type:"text"},on:{click:e.stop}},[e._v(" SMTP server listening on port "+e._s(e.server.portNumber))]):e._e(),!e.server||e.server.isRunning||e.server.exception?e._e():s("el-button",{attrs:{icon:"el-icon-circle-close",type:"danger"},on:{click:e.start}},[e._v(" SMTP server stopped")]),e.server&&!e.server.isRunning&&e.server.exception?s("el-button",{attrs:{icon:"el-icon-circle-close",type:"danger"},on:{click:e.start}},[e._v(" SMTP server error:"),s("br"),e._v(e._s(e.server.exception))]):e._e()],1)},Xe=[];let et=class extends a["default"]{constructor(){super(),this.connection=null,this.error=null,this.mutex=new y["a"],this.loading=!0,this.server=null}async refresh(e=!1){var t=await this.mutex.acquire();try{this.error=null,this.loading=!e,this.server=await(new E).getServer()}catch(s){this.error=s}finally{this.loading=!1,t()}}async stop(){let e={...this.server};e.isRunning=!1,await(new E).updateServer(e)}async start(){let e={...this.server};e.isRunning=!0,await(new E).updateServer(e)}async mounted(){await this.refresh()}onConnectionChanged(){this.connection&&(this.connection.on("serverchanged",async()=>{await this.refresh()}),this.connection.addOnConnectedCallback(()=>this.refresh()))}};Object(h["a"])([Object(m["b"])({default:null})],et.prototype,"connection",void 0),Object(h["a"])([Object(m["c"])("connection")],et.prototype,"onConnectionChanged",null),et=Object(h["a"])([m["a"]],et);var tt=et,st=tt,at=Object(x["a"])(st,Qe,Xe,!1,null,null,null),nt=at.exports,it=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"Settings",visible:e.visible,width:"80%","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t},open:e.refresh}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.error?s("el-alert",{attrs:{type:"error",title:"Error","show-icon":""}},[e._v(" "+e._s(e.error.message)+" ")]):e._e(),e.server?s("el-form",{ref:"form",attrs:{model:this,rules:e.rules,disabled:e.saving}},[s("el-tabs",{attrs:{"tab-position":"top"}},[s("el-tab-pane",{attrs:{label:"SMTP Server"}},[s("el-form-item",{attrs:{label:"Hostname",prop:"server.hostName"}},[s("el-input",{model:{value:e.server.hostName,callback:function(t){e.$set(e.server,"hostName",t)},expression:"server.hostName"}})],1),s("el-form-item",{attrs:{label:"Port Number",prop:"server.portNumber"}},[s("el-input-number",{attrs:{min:1,max:65535,"controls-position":"right"},model:{value:e.server.portNumber,callback:function(t){e.$set(e.server,"portNumber",t)},expression:"server.portNumber"}})],1),s("el-form-item",{attrs:{label:"Allow Remote Connections",prop:"server.allowRemoteConnections"}},[s("el-switch",{model:{value:e.server.allowRemoteConnections,callback:function(t){e.$set(e.server,"allowRemoteConnections",t)},expression:"server.allowRemoteConnections"}})],1)],1),s("el-tab-pane",{attrs:{label:"IMAP Server"}},[s("el-form-item",{attrs:{label:"Port Number",prop:"server.imapPortNumber"}},[s("el-input-number",{attrs:{min:1,max:65535,"controls-position":"right"},model:{value:e.server.imapPortNumber,callback:function(t){e.$set(e.server,"imapPortNumber",t)},expression:"server.imapPortNumber"}})],1)],1),s("el-tab-pane",{attrs:{label:"Limits"}},[s("el-form-item",{attrs:{label:"# of Messages to Keep",prop:"server.numberOfMessagesToKeep"}},[s("el-input-number",{attrs:{min:1,"controls-position":"right"},model:{value:e.server.numberOfMessagesToKeep,callback:function(t){e.$set(e.server,"numberOfMessagesToKeep",t)},expression:"server.numberOfMessagesToKeep"}})],1),s("el-form-item",{attrs:{label:"# of Sessions to Keep",prop:"server.numberOfSessionsToKeep"}},[s("el-input-number",{attrs:{min:1,"controls-position":"right"},model:{value:e.server.numberOfSessionsToKeep,callback:function(t){e.$set(e.server,"numberOfSessionsToKeep",t)},expression:"server.numberOfSessionsToKeep"}})],1)],1),s("el-tab-pane",{attrs:{label:"Message Relay"}},[s("el-form-item",{attrs:{label:"Message Relay Enabled",prop:"isRelayEnabled"}},[s("el-switch",{model:{value:e.isRelayEnabled,callback:function(t){e.isRelayEnabled=t},expression:"isRelayEnabled"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"SMTP server",prop:"server.relayOptions.smtpServer"}},[s("el-input",{model:{value:e.server.relayOptions.smtpServer,callback:function(t){e.$set(e.server.relayOptions,"smtpServer",t)},expression:"server.relayOptions.smtpServer"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"SMTP port",prop:"server.relayOptions.smtpPort"}},[s("el-input-number",{attrs:{min:1,max:65535,"controls-position":"right"},model:{value:e.server.relayOptions.smtpPort,callback:function(t){e.$set(e.server.relayOptions,"smtpPort",t)},expression:"server.relayOptions.smtpPort"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"Login",prop:"server.relayOptions.login"}},[s("el-input",{model:{value:e.server.relayOptions.login,callback:function(t){e.$set(e.server.relayOptions,"login",t)},expression:"server.relayOptions.login"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"Password",prop:"server.relayOptions.password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.server.relayOptions.password,callback:function(t){e.$set(e.server.relayOptions,"password",t)},expression:"server.relayOptions.password"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"Sender Address - leave blank to use original sender",prop:"server.relayOptions.senderAddress"}},[s("el-input",{model:{value:e.server.relayOptions.senderAddress,callback:function(t){e.$set(e.server.relayOptions,"senderAddress",t)},expression:"server.relayOptions.senderAddress"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isRelayEnabled,expression:"isRelayEnabled"}],attrs:{label:"Auto-Relay Recipients",prop:"isRelayEnabled"}},[e._l(e.server.relayOptions.automaticEmails,(function(t,a){return s("div",{key:a},[s("el-form-item",{attrs:{prop:"relayOptionsAutomaticEmails["+a+"].value",rules:{required:!0,message:"Required"}}},[s("el-input",{model:{value:e.server.relayOptions.automaticEmails[a],callback:function(t){e.$set(e.server.relayOptions.automaticEmails,a,t)},expression:"server.relayOptions.automaticEmails[index]"}},[s("el-button",{attrs:{slot:"append"},on:{click:function(t){return e.server.relayOptions.automaticEmails.splice(a,1)}},slot:"append"},[e._v("Remove")])],1)],1)],1)})),s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.server.relayOptions.automaticEmails.push("")}}},[e._v("New Auto-Relay Recipient")])],2)],1)],1)],1):e._e()],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{disabled:e.saving,loading:e.saving},on:{click:e.save}},[e._v("Save")])],1)])},rt=[];let lt=class extends a["default"]{constructor(){super(),this.connection=null,this.error=null,this.mutex=new y["a"],this.loading=!0,this.saving=!1,this.server=null,this.visible=!1,this.isRelayEnabledValue=!1,this.relayOptionsAutomaticEmails=[]}get rules(){let e={server:{hostName:[{required:!0,message:"Hostname is required"}],portNumber:[{required:!0,message:"Port number is required"}],numberOfMessagesToKeep:[{required:!0,message:"# of Messages to Keep is required"}],numberOfSessionsToKeep:[{required:!0,message:"# of Sessions to Keep is required"}],relayOptions:{smtpServer:[],smtpPort:[]}}};return this.isRelayEnabled&&(e.server.relayOptions.smtpServer.push({required:!0,message:"SMTP server is required if relaying enabled"}),e.server.relayOptions.smtpPort.push({required:!0,message:"SMTP port is required if relaying enabled"})),e}handleClose(){this.$emit("closed")}get isRelayEnabled(){return this.isRelayEnabledValue}set isRelayEnabled(e){this.isRelayEnabledValue=e,!this.isRelayEnabledValue&&this.server&&(this.server.relayOptions.smtpServer="",this.server.relayOptions.automaticEmails.splice(0,this.server.relayOptions.automaticEmails.length))}updateAutomaticEmailsForValidation(){this.server&&(this.relayOptionsAutomaticEmails=this.server.relayOptions.automaticEmails.map((e,t)=>({value:e})))}async save(){this.saving=!0,this.error=null;try{let e=await this.$refs["form"].validate();e&&(await(new E).updateServer(this.server),this.handleClose())}catch(e){this.error=e}finally{this.saving=!1}}async refresh(e=!1){var t=await this.mutex.acquire();try{this.error=null,this.loading=!e,this.server=await(new E).getServer(),this.isRelayEnabled=!!this.server.relayOptions.smtpServer}catch(s){this.error=s}finally{this.loading=!1,t()}}async mounted(){await this.refresh()}onConnectionChanged(){this.connection&&(this.connection.on("serverchanged",async()=>{await this.refresh()}),this.connection.addOnConnectedCallback(()=>this.refresh()))}};Object(h["a"])([Object(m["b"])({default:null})],lt.prototype,"connection",void 0),Object(h["a"])([Object(m["b"])({default:!1})],lt.prototype,"visible",void 0),Object(h["a"])([Object(m["c"])("server.relayOptions.automaticEmails")],lt.prototype,"updateAutomaticEmailsForValidation",null),Object(h["a"])([Object(m["c"])("connection")],lt.prototype,"onConnectionChanged",null),lt=Object(h["a"])([m["a"]],lt);var ot=lt,ct=ot,dt=Object(x["a"])(ct,it,rt,!1,null,null,null),ut=dt.exports,ht=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.connection||!e.connection.connected,expression:"!connection || !connection.connected"}],attrs:{size:"small",type:e.buttonType(),icon:e.buttonIcon(),title:e.buttonTitle()},on:{click:e.buttonClick}},[e._v(e._s(e.buttonText()))])},mt=[];let gt=class extends a["default"]{constructor(){super(),this.connection=null,this.buttonClick=()=>{this.connection&&(this.connection.started?this.connection.stop():this.connection.start())}}buttonType(){return this.connection&&this.connection.connected?"success":this.connection&&this.connection.started?"warning":"danger"}buttonText(){var e=this.connection&&this.connection.error?"\nError: "+this.connection.error.message:"";return(this.connection&&this.connection.connected?"Auto refresh enabled":this.connection&&this.connection.started?"Connecting...":"Auto refresh disabled")+e}buttonTitle(){var e=this.connection&&this.connection.error?"\nError: "+this.connection.error.message:"";return(this.connection&&this.connection.connected?"Auto refresh enabled - Click to disconnect":this.connection&&this.connection.started?"Auto refresh re-connecting...":"Auto refresh disabled - click to enable")+e}buttonIcon(){return this.connection&&this.connection.connected?"el-icon-success":(this.connection&&this.connection.started,"el-icon-warning")}async created(){}async destroyed(){}};Object(h["a"])([Object(m["b"])({default:null})],gt.prototype,"connection",void 0),gt=Object(h["a"])([m["a"]],gt);var pt=gt,ft=pt,bt=Object(x["a"])(ft,ht,mt,!1,null,null,null),vt=bt.exports,yt=s("512e");s("c1ea");let wt=class extends a["default"]{constructor(){super(),this.selectedMessage=null,this.selectedSession=null,this.connection=null,this.settingsVisible=!1}selectedMessageChanged(e){this.selectedMessage=e}selectedSessionChanged(e){this.selectedSession=e}get messageListPaneSize(){var e=window.localStorage.getItem("messagelist-panelsize");return e?Number(e):40}set messageListPaneSize(e){window.localStorage.setItem("messagelist-panelsize",e.toString())}get sessionListPaneSize(){var e=window.localStorage.getItem("sessionlist-panelsize");return e?Number(e):40}set sessionListPaneSize(e){window.localStorage.setItem("sessionlist-panelsize",e.toString())}async mounted(){this.connection=new Ge("hubs/notifications"),this.connection.start()}destroyed(){this.connection&&this.connection.stop()}};wt=Object(h["a"])([Object(m["a"])({components:{messagelist:z,messageview:Te,sessionlist:Ke,sessionview:Je,hubconnstatus:vt,serverstatus:nt,settingsdialog:ut,splitpanes:yt["Splitpanes"],pane:yt["Pane"]}})],wt);var jt=wt,_t=jt,St=Object(x["a"])(_t,d,u,!1,null,null,null),Ct=St.exports,Ot=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"vfillpanel",attrs:{id:"app-root"}},[s("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[s("router-view")],1)],1)},Mt=[];let xt=class extends a["default"]{};xt=Object(h["a"])([Object(m["a"])({})],xt);var kt=xt,Rt=kt,Et=(s("d5a5"),Object(x["a"])(Rt,Ot,Mt,!1,null,null,null)),Pt=Et.exports;const Nt="undefined"!=typeof document.createElement("p").style.flex&&Object.prototype.hasOwnProperty.call(window,"Reflect")&&Object.prototype.hasOwnProperty.call(window,"Promise");if(Nt){a["default"].use(r.a),a["default"].use(n["a"]);const e=[{path:"/",component:Ct}],t=new n["a"]({base:location.pathname,mode:"history",routes:e});new a["default"]({el:"#app-root",router:t,render:e=>e(Pt)});o.a.interceptors.response.use(e=>(Tt(e.data),e)),Object(c["a"])()}else document.getElementById("loading").style.display="none",document.getElementById("oldbrowser").style.display="block";const $t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*))(?:Z|(\+|-)([\d|:]*))?$/;function Tt(e){if(e instanceof Array)for(const t of e)Tt(t);else for(const t in e){const s=e[t];"string"===typeof s?$t.test(s)&&(e[t]=new Date(s)):Tt(s)}}},d5a5:function(e,t,s){"use strict";s("82e5")},fe55:function(e,t,s){}});
//# sourceMappingURL=app.ff357c64.js.map